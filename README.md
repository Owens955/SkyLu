



###开发日志 
## 前面零零散散的不想记录了
##2020-5-25  
将原本的key-value服务器的内容用网络库的框架重新写了一遍，同时用memaslap压测，性能仍然相差甚大。

观察火焰图，总结以下几点明日改进： 

1. 缺少seesion层。原本导师所说的seesion 并不是特别理解，当实际要优化的时候忽然懂了，这一层相当于用来缓存每个会话
状态等相关信息。

2. unordered_map 性能很差。网上看了其他人的hash实现方案，用了其中一个的发现性能更差了，不知道是不是自己的原因。

3. 后续继续完成持久化的部分

##2020-5-26
1. 添加了session层用来进行具体的业务处理。

2. 改用item 来存储具体的键值对

3.  增加bytestring来存储c语言的字符串，避免频繁使用string的拷贝构造带来的性能开销


##2020-5-28
1. 基本实现AOF持久化，采用mmap将文件映射到内存中进行操作。

2. 当文件过大时会在下一次写操作的时候进行重写， 同时在重写期间的写操作将会放入aof重写缓冲区中，也就是此时有
两个缓冲区。

3. 采用定时器，1s间隔sync到磁盘一次。


##2020-5-29
1. 实现重启恢复

2. 修复一些bug

##2020-5-30
1. 优化性能： 开启编译器优化后-o2可以达到memcached的读写性能

2. 修改skylu网络库中的一些小细节（优化性能）



